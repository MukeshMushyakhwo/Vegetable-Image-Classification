
# Vegetable Image Classification

The purpose of this project is to create and train a CNN model to classify images of vegetables. The model is trained on a dataset of vegetable images, with the goal of achieving accurate classification and evaluating its performance.It gives 97% accuracy on test and validation data. 

## Dataset 
The dataset used for this project is sourced from [Kaagle]("https://www.kaggle.com/datasets/misrakahmed/vegetable-image-dataset/") and contains images of various vegetables. It includes a training set, a test set, and a validation set. Classes of vegetables inlisted are:
* Bean
* Bitter Gourd
* Bottle Gourd
* Brinjal
* Broccoli
* Cabbage
* Capsicum
* Carrot
* Cauliflower
* Cucumber
* Papaya
* Potato
* Pumpkin
* Radish
* Tomato

## Libraries used
* `opendatasets`: Used to download the vegetable image dataset from Kaggle.
* `os`: Provides functions for interacting with the operating system.
* `random`: Used to generate random numbers and samples.
* `numpy` : Library for numerical computations.
* `tensorflow`: Deep learning framework for creating and training models.
* `matplotlib`: Library for creating visualizations.
* `sklearn`: Library for machine learning utilities.


# Model Architecture
A Sequential CNN model is constructed using TensorFlow's Keras API. The model consists of convolutional layers with max-pooling, followed by global average pooling and fully connected layers. The architecture aims to learn hierarchical features from the input images. Model was trained on 20 epoches that achieve 97% accuracy on both test and validation data.


A `Convolutional Neural Network (CNN)` is a specialized type of neural network designed to process and analyze visual data, such as images. CNNs are particularly effective for tasks like image classification, object detection, and image segmentation. They are inspired by the visual processing mechanism of the human brain and are well-suited to capture hierarchical features in images.

### Key components of a CNN include:
* Convolutional Layers: These layers apply filters (also known as kernels) to the input image, extracting specific features through convolution operations. Filters slide across the image, capturing patterns like edges, textures, and shapes.

* Pooling Layers: Pooling layers downsample the spatial dimensions of the feature maps generated by the convolutional layers. This reduces the computational complexity and helps retain important features while discarding irrelevant details.

* Activation Functions: Activation functions introduce non-linearity to the network, allowing it to learn complex relationships in the data. Common activation functions include ReLU (Rectified Linear Activation) and its variants.

* Fully Connected Layers: These layers perform the final classification based on the features extracted by the convolutional layers. They combine the features and make predictions.

* Dropout: Dropout is a regularization technique that randomly sets a fraction of the neurons to zero during training, preventing overfitting and enhancing generalization.

* Batch Normalization: Batch normalization normalizes the outputs of intermediate layers, improving training stability and convergence.


# Performance Evaluation
## Classificaion Report
A classification report is a summary of various performance metrics for each class in a classification problem. It provides a more detailed view of the model's behavior beyond accuracy. It provides detailed metrics such as precision, recall, and F1-score for each class.
Evaluation of performance on classificaion are as follows:
* Precision = 97.77%
* Recall = 97.77%
* F1-score = 97.77%
These metrics provide insights into the model's performance on a per-class basis.

## Confusion matrix
A confusion matrix is a tabular representation that shows the performance of a classification model on a set of test data for which the true labels are known. It provides a detailed breakdown of the model's predictions and actual outcomes for each class. The matrix helps visualize the model's performance in terms of correct and incorrect classifications for each class. The confucion matrix of the model on test data is illustrated below:
![Confusion matrix](https://github.com/MukeshMushyakhwo/Vegetable-Image-Classification/blob/main/Evaluation%20Image/confusion_matrix.png?raw=true)



## Training and validation accuracy

![Accuracy](https://github.com/MukeshMushyakhwo/Vegetable-Image-Classification/blob/main/Evaluation%20Image/train_val_accuracy.png?raw=true)
* The training accuracy (proportion of correct predictions on the training data) starts at 34.97% and steadily increases to 95.95% by the final epoch. The model is becoming more accurate in classifying training samples.
* The validation accuracy starts at 54.87% and increases to 97.07% by the end of training. This indicates that the model is becoming highly accurate in predicting classes on new, unseen data.

## Training and validation loss
![Loss](https://github.com/MukeshMushyakhwo/Vegetable-Image-Classification/blob/main/Evaluation%20Image/train_val_loss.png?raw=true)
* The training loss (a measure of how well the model's predictions match the true labels) starts at a relatively high value of 2.0711 in the first epoch and progressively decreases with each epoch. This indicates that the model is learning to make better predictions.
* The validation loss (a measure of how well the model generalizes to new, unseen data) starts at 1.3073 in the first epoch and decreases consistently. This suggests that the model is also improving its performance on the validation set.

The final training loss is 0.1371, which indicates that the model's predictions are very close to the true labels. The final training accuracy is 95.95%, suggesting that the model correctly classifies the majority of training samples.

The final validation loss is 0.1172, which is quite low. This indicates that the model's performance on new, unseen data is very good. The final validation accuracy is 97.07%, reflecting the model's ability to generalize well.

The overall trend of decreasing loss and increasing accuracy for both training and validation data suggests that the model has learned to recognize patterns and features in the images effectively.


# Conclusion

The vegetable image classification project was a success. The model achieved an accuracy of 97% on the test data, and the confusion matrix showed that the model was able to correctly classify most of the images. The Streamlit web application allows users to interact with the model and easily classify vegetables.

There are a few ways to improve the model. One way would be to use a larger dataset. The current dataset contains 13,000 images, but a larger dataset would allow the model to learn more about the different types of vegetables. Another way to improve the model would be to train it for more epochs. The current model was trained for 20 epochs, but training it for more epochs would allow the model to learn more complex features.

This code demonstrates the complete process of building, training, and evaluating a CNN model for classifying vegetable images. The model's performance is evaluated using various metrics, and visualizations are provided to aid in understanding the results.

# Streamlit Integration
A Streamlit web application was created to allow users to interact with the model. The web application allows users to upload an image of a vegetable, and the model will then predict the class of the vegetable.
The following steps are required to run the Streamlit web application:

Install the streamlit library
```
pip install streamlit
```
Run the following command in terminal.
```
streamlit run classification.py
```
The web application will then be launched in a browser.


## Result
Streamlit Web interface
![Image](https://github.com/MukeshMushyakhwo/Vegetable-Image-Classification/blob/main/Streamlit-result/web_interface.png?raw=true)


Upload Image for prediction.
![Image](https://github.com/MukeshMushyakhwo/Vegetable-Image-Classification/blob/main/Streamlit-result/prediction1.png?raw=true)

![Image](https://github.com/MukeshMushyakhwo/Vegetable-Image-Classification/blob/main/Streamlit-result/prediction2.png?raw=true)

The model was able to correctly predict the class of the vegetables.